---
title: "Quantitative Analysis Group Assignment"
author: "Mark Hill + The Dai Quach"
date: "26/09/2021"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r install packages, eval=FALSE, include=FALSE}
install.packages("tidyverse")
install.packages("lubridate")
install.packages("magrittr")
install.packages("tidyquant")
install.packages("tidymodels")


```

```{r load packages, include=FALSE}
library(tidyverse)
library(lubridate)
library(magrittr)
library(tidyquant)
library(tidymodels)
library(timetk)
```

```{r initial data tidying, include=FALSE}

RIO_AX_raw <- tq_get("RIO.AX", get  = "stock.prices", from="1999-01-04")

RIO_AX <- RIO_AX_raw %>% filter(is.na(open) == FALSE) %>% select(Date = date, Price = open)


```

```{r calculating returns, include=FALSE}
#calculate return using periodReturn, add it as a column, add a lagged column

RIO_AX_daily <- RIO_AX %>% tq_mutate(select = Price, mutate_fun = periodReturn,
              period = "daily", col_rename = "Daily Return") %>% mutate(`Return lagged by 1 day` = lag(`Daily Return`)) 

RIO_AX_weekly <- RIO_AX %>% tq_transmute(select = Price, mutate_fun = periodReturn, period = "weekly", col_rename = "Weekly Return" ) %>% left_join(RIO_AX) %>% relocate(Price, .after = Date )  %>% mutate(`Return lagged by 1 day` = lag(`Weekly Return`))

RIO_AX_monthly <- RIO_AX %>% tq_transmute(select = Price, mutate_fun = periodReturn, period = "monthly", col_rename = "Monthly Return" ) %>% left_join(RIO_AX) %>% relocate(Price, .after = Date ) %>% mutate(`Return lagged by 1 day` = lag(`Monthly Return`))
```


## Introduction
Our report investigates Rio Tinto, a large  We chose Rio Tinto because of the recent developments in the commodities market, with the iron ore price dropping by more than half. Rio Tinto is the largest producer of iron ore in Australia.

We chose to use [daily/weekly/monthly] data, because ...
We gathered all the available stock information for the company, but chose to focus on the time period _____ to the present

## Background
Rio Tinto is an Austrailan metals and mining company, founded in 1873. With a net profit of $10.4 billion USD, 45,000 employees, is one of the largest companies on the Australian Stock Exchange, and one of the largest mining companies in the world. 

## Methodology

```{r summary statistics, echo=FALSE}
summary(RIO_AX_daily)
```

```{r Regression Analysis, echo=TRUE}
RET_regression_daily <- lm(data = RIO_AX_daily, `Daily Return` ~ `Return lagged by 1 day`)
RET_regression_weekly <- lm(data = RIO_AX_weekly,`Weekly Return` ~ `Return lagged by 1 day`)
RET_regression_monthly <- lm(data = RIO_AX_monthly, `Monthly Return` ~ `Return lagged by 1 day`)
```


```{r plotting return vs return of previous day}
ggplot(data = RIO_AX_daily, aes(y= `Daily Return`, x = `Return lagged by 1 day`)) + geom_line() + ggtitle("Return on Rio Tinto shares, vs. Return of Previous Day") + theme(plot.title = element_text(hjust = 0.5))
```


## Results
```{r ACF calculation, include=FALSE}

daily_acf <- tk_acf_diagnostics(RIO_AX_daily, .date_var = Date, .value = `Daily Return`)
weekly_acf <- tk_acf_diagnostics(RIO_AX_weekly, .date_var = Date, .value = `Weekly Return`)
monthly_acf <- tk_acf_diagnostics(RIO_AX_monthly, .date_var = Date, .value = `Monthly Return`)
  
```

```{r plot ACF, echo=FALSE}
daily_acf %>% ggplot(aes(x= lag)) + geom_point(aes(y= ACF)) + geom_line(aes(y= .white_noise_upper)) + geom_line(aes(y= .white_noise_lower)) 
```




```{r Regression Summary Table, echo=FALSE}
tidy(RET_regression_daily)
glance(RET_regression_daily) %>% select(`Number of Observations` = nobs, `Adjusted R Squared` = adj.r.squared)

tidy(RET_regression_weekly)
glance(RET_regression_weekly) %>% select(`Number of Observations` = nobs, `Adjusted R Squared` = adj.r.squared)

tidy(RET_regression_monthly)
glance(RET_regression_monthly) %>% select(`Number of Observations` = nobs, `Adjusted R Squared` = adj.r.squared)

```

## Recommendations

## Conclusion